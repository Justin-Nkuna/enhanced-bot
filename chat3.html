<script type="text/javascript">
  function initEmbeddedMessaging() {
    try {
      // Check if embeddedservice_bootstrap is available
      if (!window.embeddedservice_bootstrap) {
        console.error("embeddedservice_bootstrap is not defined");
        return;
      }

      // Set language
      embeddedservice_bootstrap.settings.language = 'en_US'; // Adjust language as needed

      // Initialize the Embedded Messaging with correct Deployment ID, Chatbot, and URL
      embeddedservice_bootstrap.init(
        '00Ddw0000007iNh', // Deployment ID
        'ChatBot_Messaging', // Chat Configuration Name
        'https://capeunionmart--dev.sandbox.my.site.com/ESWChatBotMessaging1728460303739', // Your URL
        {
          scrt2URL: 'https://capeunionmart--dev.sandbox.my.salesforce-scrt.com' // Optional settings
        }
      );
    } catch (err) {
      console.error('Error loading Embedded Messaging:', err);
    }
  }

  // Load the Salesforce Embedded Service script first
  if (!window.embedded_svc) {
    var script = document.createElement('script');
    script.setAttribute('src', 'https://service.force.com/embeddedservice/5.0/esw.min.js');
    script.onload = function() {
      console.log("Salesforce Embedded Service script loaded.");
      initEmbeddedMessaging(); // Initialize after script is loaded
    };
    document.body.appendChild(script);
  } else {
    initEmbeddedMessaging(); // If script already loaded, initialize right away
  }
</script>

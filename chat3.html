<!DOCTYPE html>
<html>
<head>
  <title>Embedded Messaging Chat</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>   
</head>
<body>
  <div id="embedded-chat"></div>

  <script type='text/javascript'>
    // Function to initialize Embedded Messaging
    function initEmbeddedMessaging() {
      // Check if embeddedservice_bootstrap is available
      if (typeof embeddedservice_bootstrap === 'undefined') {
        console.error("embeddedservice_bootstrap is not defined.");
        return;
      }

      console.log('Initializing Embedded Messaging');

      // Set default language
      embeddedservice_bootstrap.settings.language = 'en_US';

      // Initialize Embedded Messaging with configuration parameters
      embeddedservice_bootstrap.init(
        '00Ddw0000007iNh', // Deployment ID
        'Gihub_Deployment', // Chat Configuration Name
        'https://capeunionmart--dev.sandbox.my.site.com/ESWGihubDeployment1728631807080', // Your actual website URL
        {
          scrt2URL: 'https://capeunionmart--dev.sandbox.my.salesforce-scrt.com' // Optional settings
        }
      );
    }

    // Load the Salesforce Embedded Service script dynamically
    function loadEmbeddedServiceScript(callback) {
      var script = document.createElement('script');
      script.src = 'https://service.force.com/embeddedservice/5.0/esw.min.js';
      script.onload = callback; // Call init after the script is loaded
      script.onerror = function() {
        console.error("Failed to load Salesforce Embedded Service script.");
      };
      document.body.appendChild(script);
    }

    // Check if the embedded service script is already loaded
    if (typeof embeddedservice_bootstrap !== 'undefined') {
      initEmbeddedMessaging();
    } else {
      loadEmbeddedServiceScript(function() {
        // Wait a moment for embeddedservice_bootstrap to be defined
        setTimeout(initEmbeddedMessaging, 1000);
      });
    }
  </script>
</body>
</html>

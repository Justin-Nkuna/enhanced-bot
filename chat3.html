<script type="text/javascript">
  function initEmbeddedMessaging() {
    try {
      // Check if embeddedservice_bootstrap is available
      if (!window.embeddedservice_bootstrap) {
        console.error("embeddedservice_bootstrap is not defined");
        return;
      }

      // Set language and initialize embedded service
      embeddedservice_bootstrap.settings.language = 'en_US'; // Set language as needed
      embeddedservice_bootstrap.init(
        '00Ddw0000007iNh', // Deployment ID
        'ChatBot_Messaging', // Chat Configuration Name
        'https://capeunionmart--dev.sandbox.my.site.com/ESWChatBotMessaging1728460303739', // Site URL
        {
          scrt2URL: 'https://capeunionmart--dev.sandbox.my.salesforce-scrt.com' // Optional settings
        }
      );
    } catch (err) {
      console.error('Error loading Embedded Messaging:', err);
    }
  }

  // Ensure the Salesforce Embedded Service script is loaded first
  if (!window.embedded_svc) {
    var script = document.createElement('script');
    script.setAttribute('src', 'https://service.force.com/embeddedservice/5.0/esw.min.js'); // Load Salesforce Embedded Service script
    script.onload = function() {
      console.log("Salesforce Embedded Service script loaded.");
      initEmbeddedMessaging(); // Initialize chat once the script has loaded
    };
    document.body.appendChild(script);
  } else {
    initEmbeddedMessaging(); // If script is already loaded, initialize directly
  }
</script>
